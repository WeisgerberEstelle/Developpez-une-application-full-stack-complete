@if (user) {
  <div class="profile-container">
    <h1>Profil</h1>

    <mat-card class="profile-form-card">
      <mat-card-content>
        <form (ngSubmit)="onSave()">
          <mat-form-field appearance="outline">
            <mat-label>Email</mat-label>
            <input matInput [(ngModel)]="email" name="email" type="email" />
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Nom d'utilisateur</mat-label>
            <input matInput [(ngModel)]="username" name="username" />
          </mat-form-field>

          <mat-form-field appearance="outline">
            <mat-label>Nouveau mot de passe</mat-label>
            <input matInput [(ngModel)]="password" name="password" type="password"
                   placeholder="Laisser vide pour ne pas changer" />
          </mat-form-field>

          @if (successMessage || errorMessage) {
            <div class="messages">
              @if (successMessage) {
                <p class="success">{{ successMessage }}</p>
              }
              @if (errorMessage) {
                <p class="error">{{ errorMessage }}</p>
              }
            </div>
          }

          <button mat-raised-button color="primary" type="submit">Sauvegarder</button>
        </form>
      </mat-card-content>
    </mat-card>

    <h2>Abonnements</h2>

    @if (user.subscriptions.length > 0) {
      <div class="subscriptions-list">
        @for (topic of user.subscriptions; track topic.id) {
          <mat-card class="subscription-card">
            <mat-card-header>
              <mat-card-title>{{ topic.name }}</mat-card-title>
            </mat-card-header>
            <mat-card-content>
              <p>{{ topic.description }}</p>
            </mat-card-content>
            <mat-card-actions>
              <button mat-raised-button color="warn" (click)="unsubscribe(topic.id)">
                Se désabonner
              </button>
            </mat-card-actions>
          </mat-card>
        }
      </div>
    } @else {
      <p>Aucun abonnement pour le moment.</p>
    }

    <div class="logout-section">
      <button mat-raised-button (click)="logout()">Se déconnecter</button>
    </div>
  </div>
}
